<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Missa Main - Organização de Cânticos</title>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Ubuntu Mono', monospace;
            background: linear-gradient(135deg, #000000 0%, #2c2c2c 25%, #4a4a4a 50%, #c0c0c0 75%, #ffffff 100%);
            min-height: 100vh;
            color: #ffffff;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .header h1 {
            font-size: 2.5rem;
            color: #ffff00;
            text-shadow: 0 0 20px #ffff00;
            margin-bottom: 10px;
        }

        .search-container {
            margin: 20px 0;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            color: #ffffff;
            font-family: 'Ubuntu Mono', monospace;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            border-color: #ffff00;
            box-shadow: 0 0 20px rgba(255, 255, 0, 0.3);
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .search-result-item {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: background 0.3s ease;
        }

        .search-result-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            margin-bottom: 30px;
        }

        .sections-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .section-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .section-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }

        .section-header {
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #ffffff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .section-toggle {
            font-size: 1.5rem;
            color: #ffff00;
            transition: transform 0.3s ease;
        }

        .section-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .section-content.expanded {
            max-height: 400px;
            overflow-y: auto;
        }

        .song-item {
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            draggable: true;
        }

        .song-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .song-name {
            flex: 1;
            color: #ffffff;
            font-size: 0.9rem;
        }

        .add-btn {
            background: rgba(255, 255, 0, 0.2);
            border: 1px solid #ffff00;
            color: #ffff00;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .add-btn:hover {
            background: #ffff00;
            color: #000000;
            transform: scale(1.1);
        }

        .missa-hoje {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            border: 2px solid rgba(255, 255, 0, 0.5);
            box-shadow: 0 8px 32px rgba(255, 255, 0, 0.2);
            padding: 20px;
            position: sticky;
            top: 20px;
            height: fit-content;
        }

        .missa-hoje h2 {
            color: #ffff00;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.5rem;
            text-shadow: 0 0 15px #ffff00;
        }

        .missa-list {
            min-height: 200px;
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.2);
        }

        .missa-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .missa-item .remove-btn {
            background: rgba(255, 0, 0, 0.3);
            border: 1px solid #ff0000;
            color: #ff0000;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .missa-item .remove-btn:hover {
            background: #ff0000;
            color: #ffffff;
        }

        .control-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .control-btn {
            flex: 1;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Ubuntu Mono', monospace;
            font-size: 0.9rem;
            min-width: 80px;
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .control-btn.save {
            border-color: #00ff00;
            color: #00ff00;
        }

        .control-btn.clear {
            border-color: #ff0000;
            color: #ff0000;
        }

        .control-btn.load {
            border-color: #00ffff;
            color: #00ffff;
        }

        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .popup-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 20px;
            max-width: 90vw;
            max-height: 90vh;
            overflow: auto;
            position: relative;
        }

        .popup-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: rgba(255, 0, 0, 0.3);
            border: 1px solid #ff0000;
            color: #ff0000;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .popup-close:hover {
            background: #ff0000;
            color: #ffffff;
        }

        .pdf-viewer {
            width: 100%;
            height: 70vh;
            border: none;
            border-radius: 10px;
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }

            .missa-hoje {
                position: relative;
                top: 0;
                order: -1;
            }

            .sections-container {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2rem;
            }

            .control-buttons {
                flex-direction: column;
            }

            .control-btn {
                min-width: auto;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 1.5rem;
            }

            .section-title {
                font-size: 1rem;
            }

            .song-name {
                font-size: 0.8rem;
            }
        }

        /* Animações */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-card {
            animation: fadeIn 0.5s ease forwards;
        }

        /* Drag and Drop */
        .dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .drop-zone {
            border-color: #ffff00 !important;
            background: rgba(255, 255, 0, 0.1) !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎵 Missa Main</h1>
            <p>Organização de Cânticos Litúrgicos</p>
        </div>

        <div class="search-container">
            <input type="text" class="search-input" placeholder="Pesquisar cânticos por trechos da letra..." id="searchInput">
            <div class="search-results" id="searchResults"></div>
        </div>

        <div class="main-grid">
            <div class="sections-container" id="sectionsContainer">
                <!-- Seções serão geradas dinamicamente -->
            </div>

            <div class="missa-hoje">
                <h2>🙏 Missa de Hoje</h2>
                <div class="missa-list" id="missaList">
                    <p style="text-align: center; color: rgba(255,255,255,0.7); font-style: italic;">
                        Arraste os cânticos aqui para organizar a missa
                    </p>
                </div>
                <div class="control-buttons">
                    <button class="control-btn save" onclick="saveMissa()">💾 Salvar</button>
                    <button class="control-btn clear" onclick="clearMissa()">🗑️ Limpar</button>
                    <button class="control-btn load" onclick="loadMissa()">📂 Carregar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Popup para visualização de PDF -->
    <div class="popup-overlay" id="popupOverlay">
        <div class="popup-content">
            <div class="popup-close" onclick="closePopup()">×</div>
            <iframe class="pdf-viewer" id="pdfViewer"></iframe>
        </div>
    </div>

    <script>
        // Estrutura das seções na ordem da missa
        const sections = [
            { id: '1 - Entrada', name: '🚪 Entrada', order: 1 },
            { id: '2 - Ato penitencial', name: '🙏 Ato Penitencial', order: 2 },
            { id: '3 - Gloria', name: '✨ Glória', order: 3 },
            { id: '4 - Aclamação ao evangelho', name: '📖 Aclamação ao Evangelho', order: 4 },
            { id: '5 - Ofertório', name: '🍞 Ofertório', order: 5 },
            { id: '6 - Santo', name: '👼 Santo', order: 6 },
            { id: '7 - Comunhão', name: '🍷 Comunhão', order: 7 },
            { id: '8 - Ação de Graças', name: '🙌 Ação de Graças', order: 8 },
            { id: '9 - Final', name: '🚪 Final', order: 9 },
            { id: '10 - Abraço de Paz', name: '🤝 Abraço de Paz', order: 10 },
            { id: '15 - Abraço de Paz', name: '🤝 Abraço de Paz (Alt)', order: 11 },
            { id: '16 - Cordeiro', name: '🐑 Cordeiro', order: 12 },
            { id: '11 - Canticos Marianos', name: '👸 Cânticos Marianos', order: 13 },
            { id: '12 - Louvor e meditação', name: '🎵 Louvor e Meditação', order: 14 },
            { id: '13 - Diversos', name: '🎼 Diversos', order: 15 },
            { id: '14 - Salmos', name: '📜 Salmos', order: 16 }
        ];

        // Base URL do GitHub para acessar os PDFs
        const baseUrl = 'https://github.com/iramalho1980/missa_main/raw/main/Letras/';

        // Dados dos cânticos (simulado - em uma implementação real, isso viria de uma API)
        const songData = {};

        // Inicializar a aplicação
        document.addEventListener('DOMContentLoaded', function() {
            generateSections();
            setupEventListeners();
            loadSongData();
        });

        function generateSections() {
            const container = document.getElementById('sectionsContainer');
            
            sections.sort((a, b) => a.order - b.order).forEach(section => {
                const sectionCard = document.createElement('div');
                sectionCard.className = 'section-card';
                sectionCard.innerHTML = `
                    <div class="section-header" onclick="toggleSection('${section.id}')">
                        <div class="section-title">${section.name}</div>
                        <div class="section-toggle" id="toggle-${section.id}">▼</div>
                    </div>
                    <div class="section-content" id="content-${section.id}">
                        <div id="songs-${section.id}">
                            <div style="padding: 20px; text-align: center; color: rgba(255,255,255,0.7);">
                                Carregando cânticos...
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(sectionCard);
            });
        }

        function toggleSection(sectionId) {
            const content = document.getElementById(`content-${sectionId}`);
            const toggle = document.getElementById(`toggle-${sectionId}`);
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                toggle.textContent = '▼';
            } else {
                content.classList.add('expanded');
                toggle.textContent = '▲';
                loadSongsForSection(sectionId);
            }
        }

        function loadSongData() {
            // Simulação de dados dos cânticos
            // Em uma implementação real, isso seria carregado via API do GitHub
            const sampleSongs = {
                '1 - Entrada': [
                    'Vem, Espírito Santo',
                    'Eis-me aqui, Senhor',
                    'Somos um povo que caminha'
                ],
                '2 - Ato penitencial': [
                    'Senhor, tende piedade',
                    'Kyrie Eleison',
                    'Perdão, Senhor'
                ],
                '3 - Gloria': [
                    'Glória a Deus nas alturas',
                    'Glória ao Pai',
                    'Glória e louvor'
                ],
                '4 - Aclamação ao evangelho': [
                    'Aleluia',
                    'Aclamação',
                    'Glória a Ti, Senhor'
                ],
                '5 - Ofertório': [
                    'Recebe, ó Deus',
                    'Ofertório',
                    'Bendito sejas'
                ],
                '6 - Santo': [
                    'Santo, Santo, Santo',
                    'Sanctus',
                    'Santo é o Senhor'
                ],
                '7 - Comunhão': [
                    'Eu sou o pão da vida',
                    'Vinde a mim',
                    'Comunhão'
                ],
                '8 - Ação de Graças': [
                    'Obrigado, Senhor',
                    'Graças e louvores',
                    'Te Deum'
                ],
                '9 - Final': [
                    'Ide em paz',
                    'Que a paz do Senhor',
                    'Bênção final'
                ],
                '10 - Abraço de Paz': [
                    'A paz esteja convosco',
                    'Paz e bem',
                    'Abraço de paz'
                ],
                '15 - Abraço de Paz': [
                    'A paz de Cristo',
                    'Paz do Senhor',
                    'Abraço fraterno'
                ],
                '16 - Cordeiro': [
                    'Cordeiro de Deus',
                    'Agnus Dei',
                    'Cordeiro que tira'
                ],
                '11 - Canticos Marianos': [
                    'Ave Maria',
                    'Salve Rainha',
                    'Magnificat'
                ],
                '12 - Louvor e meditação': [
                    'Louvado seja',
                    'Meditação',
                    'Contemplação'
                ],
                '13 - Diversos': [
                    'Cântico diverso 1',
                    'Cântico diverso 2',
                    'Cântico diverso 3'
                ],
                '14 - Salmos': [
                    'Salmo 23',
                    'Salmo 150',
                    'Salmo 100'
                ]
            };

            Object.assign(songData, sampleSongs);
        }

        function loadSongsForSection(sectionId) {
            const songsContainer = document.getElementById(`songs-${sectionId}`);
            const songs = songData[sectionId] || [];
            
            if (songs.length === 0) {
                songsContainer.innerHTML = `
                    <div style="padding: 20px; text-align: center; color: rgba(255,255,255,0.7);">
                        Nenhum cântico encontrado nesta seção
                    </div>
                `;
                return;
            }

            songsContainer.innerHTML = songs.map(song => `
                <div class="song-item" draggable="true" ondragstart="dragStart(event)" data-song="${song}" data-section="${sectionId}">
                    <div class="song-name" onclick="openPDF('${sectionId}', '${song}')">${song}</div>
                    <div class="add-btn" onclick="addToMissa('${song}', '${sectionId}')">+</div>
                </div>
            `).join('');
        }

        function openPDF(sectionId, songName) {
            // Construir URL do PDF
            const pdfUrl = `${baseUrl}${encodeURIComponent(sectionId)}/${encodeURIComponent(songName)}.pdf`;
            
            // Abrir popup com PDF
            document.getElementById('pdfViewer').src = pdfUrl;
            document.getElementById('popupOverlay').style.display = 'flex';
        }

        function closePopup() {
            document.getElementById('popupOverlay').style.display = 'none';
            document.getElementById('pdfViewer').src = '';
        }

        function addToMissa(songName, sectionId) {
            const missaList = document.getElementById('missaList');
            
            // Remover mensagem de placeholder se existir
            const placeholder = missaList.querySelector('p');
            if (placeholder) {
                placeholder.remove();
            }

            // Criar item da missa
            const missaItem = document.createElement('div');
            missaItem.className = 'missa-item';
            missaItem.innerHTML = `
                <div onclick="openPDF('${sectionId}', '${songName}')" style="cursor: pointer; flex: 1;">
                    ${songName}
                </div>
                <div class="remove-btn" onclick="removeFromMissa(this)">×</div>
            `;
            
            missaList.appendChild(missaItem);
        }

        function removeFromMissa(button) {
            button.parentElement.remove();
            
            // Se não há mais itens, mostrar placeholder
            const missaList = document.getElementById('missaList');
            if (missaList.children.length === 0) {
                missaList.innerHTML = `
                    <p style="text-align: center; color: rgba(255,255,255,0.7); font-style: italic;">
                        Arraste os cânticos aqui para organizar a missa
                    </p>
                `;
            }
        }

        function saveMissa() {
            const missaItems = Array.from(document.querySelectorAll('.missa-item')).map(item => {
                const text = item.querySelector('div').textContent.trim();
                return text;
            });
            
            localStorage.setItem('missaAtual', JSON.stringify(missaItems));
            alert('Missa salva com sucesso!');
        }

        function clearMissa() {
            if (confirm('Tem certeza que deseja limpar a missa atual?')) {
                document.getElementById('missaList').innerHTML = `
                    <p style="text-align: center; color: rgba(255,255,255,0.7); font-style: italic;">
                        Arraste os cânticos aqui para organizar a missa
                    </p>
                `;
            }
        }

        function loadMissa() {
            const savedMissa = localStorage.getItem('missaAtual');
            if (savedMissa) {
                const missaItems = JSON.parse(savedMissa);
                const missaList = document.getElementById('missaList');
                
                missaList.innerHTML = '';
                
                missaItems.forEach(songName => {
                    const missaItem = document.createElement('div');
                    missaItem.className = 'missa-item';
                    missaItem.innerHTML = `
                        <div onclick="openPDF('', '${songName}')" style="cursor: pointer; flex: 1;">
                            ${songName}
                        </div>
                        <div class="remove-btn" onclick="removeFromMissa(this)">×</div>
                    `;
                    missaList.appendChild(missaItem);
                });
                
                alert('Missa carregada com sucesso!');
            } else {
                alert('Nenhuma missa salva encontrada.');
            }
        }

        function setupEventListeners() {
            // Pesquisa
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            
            searchInput.addEventListener('input', function() {
                const query = this.value.toLowerCase().trim();
                
                if (query.length < 2) {
                    searchResults.style.display = 'none';
                    return;
                }
                
                // Simular busca por trechos de letra
                const results = [];
                Object.keys(songData).forEach(sectionId => {
                    songData[sectionId].forEach(song => {
                        if (song.toLowerCase().includes(query)) {
                            results.push({ song, sectionId });
                        }
                    });
                });
                
                if (results.length > 0) {
                    searchResults.innerHTML = results.map(result => `
                        <div class="search-result-item" onclick="openPDF('${result.sectionId}', '${result.song}')">
                            ${result.song} <small>(${result.sectionId})</small>
                        </div>
                    `).join('');
                    searchResults.style.display = 'block';
                } else {
                    searchResults.innerHTML = '<div class="search-result-item">Nenhum resultado encontrado</div>';
                    searchResults.style.display = 'block';
                }
            });
            
            // Fechar resultados de pesquisa ao clicar fora
            document.addEventListener('click', function(e) {
                if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                    searchResults.style.display = 'none';
                }
            });
            
            // Drag and Drop
            const missaList = document.getElementById('missaList');
            
            missaList.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('drop-zone');
            });
            
            missaList.addEventListener('dragleave', function(e) {
                if (!this.contains(e.relatedTarget)) {
                    this.classList.remove('drop-zone');
                }
            });
            
            missaList.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('drop-zone');
                
                const songName = e.dataTransfer.getData('text/song');
                const sectionId = e.dataTransfer.getData('text/section');
                
                if (songName && sectionId) {
                    addToMissa(songName, sectionId);
                }
            });
        }

        function dragStart(e) {
            e.target.classList.add('dragging');
            e.dataTransfer.setData('text/song', e.target.dataset.song);
            e.dataTransfer.setData('text/section', e.target.dataset.section);
            
            setTimeout(() => {
                e.target.classList.remove('dragging');
            }, 0);
        }

        // Fechar popup ao clicar fora
        document.getElementById('popupOverlay').addEventListener('click', function(e) {
            if (e.target === this) {
                closePopup();
            }
        });
    </script>
</body>
</html>

